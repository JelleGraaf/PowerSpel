Function Write-OGDMap {
    param (
        $X,
        $Y,
        $Z
    )

    #Write title
    Write-Host "Kaart van deze verdieping:"

    #Convert coordinates of the room (X, Y, Z) into something usable with map.json
    $Xmap = ($X * 2) - 1
    $Ymap = 26 - ($Y * 2)
    $FloorZ = "Floor"+"$Z"

    #Import a clean version of the map from map.json and convert it to a hashtable
    $Map = Get-Content -Raw -Path "$($ModuleVariablesFolder.fullname)\map.json" | ConvertFrom-Json
    Convert-OGDPSObjectToHashtable $Hash

    #Change the character of the current location into an "X"
    $Map.$FloorZ.$Ymap[$Xmap] = "X"
    
    $i = 1
    While ($i -le 22) { #This number is deliberately lower than the map size (25), to cut white space. Raise to up to the biggest line number in map.json at your discretion.
        #Write all lines in the array to screen
        ForEach ($Obj in $Map.$FloorZ.$i) {
            #Write all characters in the current line, using colors for specials
            If ($Obj -eq "X"){
                Write-Host $Obj -NoNewline -ForegroundColor Yellow
            } elseif ($Obj -in @("U","I","T","UIT")) {
                Write-Host $Obj -NoNewline -ForegroundColor Red
            } else{
                Write-Host $Obj -NoNewline
            } #End write all characters...
        } #End write all lines...
        Write-Host
        $i ++
    } #End while

} #End function
