function Set-State { 
  param(
    [parameter(mandatory=$true,
                   ValueFromPipeline=$true)]
    [alias('state')]
    [pscustomobject]$InputObject
  )

  $StateObj = Import-Clixml -Path $script:ModuleStateFilePath

  $StateObj.state = $InputObject
  $StateObj.state.lastAction = get-date

  Export-Clixml -Path $script:ModuleStateFilePath -InputObject $StateObj -Depth 20


}