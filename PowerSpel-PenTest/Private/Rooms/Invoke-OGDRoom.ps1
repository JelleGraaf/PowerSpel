function Invoke-OGDRoom {
    param(
        $RoomNumber,
        $RoomTitle,
        $RoomDescription,
        $Exits,
        $ActionMessageNorth,
        $ActionMessageEast,
        $ActionMessageSouth,
        $ActionMessageWest,
        $ActionMessageUp,
        $ActionMessageDown
    )

    $State = Get-State
    $Global:MenuOptions = $null
    $WriteOGDOptionMenuSplat = @()

    Write-Host $ActionMessage -ForegroundColor Green
    Write-Host ""
    Write-Host $RoomTitle -ForegroundColor DarkBlue -BackgroundColor White
    Write-Host $RoomDescription
    Write-Exits $Exits.Keys
    if($state.room.$Global:RoomNumber."een toegangspasje" -eq $true){
        Write-Host 'Op de grond ligt een toegangspasje' -foregroundcolor Cyan
        $WriteOGDOptionMenuSplat += "Pak het toegangspasje op"
    }
    if($state.room.$Global:RoomNumber."een bierflesje" -eq $true){
        Write-Host 'Op de grond ligt een bierflesje' -foregroundcolor Cyan
        $WriteOGDOptionMenuSplat += "Pak het bierflesje op"
    Write-Host ""
    }
    Write-OGDOptionMenu @WriteOGDOptionMenuSplat

# CODE IN PROGRESS
#    Write-Host "State.room.`$Global:RoomNumber: $($State.room."$Global:RoomNumber")" -ForegroundColor Yellow
    
#    If ($state.room.'000002') {Write-Host "Er ligt iets in de kamer" -foregroundcolor cyan}
#    If ($state.room.'000002'.bierflesje=True) {Write-Host "Er ligt een bierflesje op de grond" -foregroundcolor yellow} else {Write-Host "Er ligt niets"}
# CODE IN PROGRESS

    $Command = Read-Host "`n`rWat wil je doen?"

    switch ($Command)
    {
        'N'{
        If ($Exits.N){
            $state.location = $Exits.N
            $global:ActionMessage = $ActionMessageNorth
            $state.Counter.roomvisits ++
        } else {
            If ($Exits.keys -contains "(N)") {$global:ActionMessage = "De deur zit op slot, je kunt er nu niet door."}
                Else {$global:ActionMessage = "Die kant kan je nu niet op."}
        }
        Break
        }
        'E'{
        If ($Exits.E){
            $state.location = $Exits.E
            $global:ActionMessage = $ActionMessageEast
            $state.Counter.roomvisits ++
        } else {
            If ($Exits.keys -contains "(E)") {$global:ActionMessage = "De deur zit op slot, je kunt er nu niet door."}
                Else {$global:ActionMessage = "Die kant kan je nu niet op."}
        }
        Break
        }
        'S'{
        If ($Exits.S){
            $state.location = $Exits.S
            $global:ActionMessage = $ActionMessageSouth
            $state.Counter.roomvisits ++
        } else {
            If ($Exits.keys -contains "(S)") {$global:ActionMessage = "De deur zit op slot, je kunt er nu niet door."}
                Else {$global:ActionMessage = "Die kant kan je nu niet op."}
        }
        Break
        }
        'W'{
        If ($Exits.W){
            $state.location = $Exits.W
            $global:ActionMessage = $ActionMessageWest
            $state.Counter.roomvisits ++
        } else {
            If ($Exits.keys -contains "(W)") {$global:ActionMessage = "De deur zit op slot, je kunt er nu niet door."}
                Else {$global:ActionMessage = "Die kant kan je nu niet op."}
        }
        Break
        }
        'U'{
        If ($Exits.U){
            $state.location = $Exits.U
            $global:ActionMessage = $ActionMessageUp
            $state.Counter.roomvisits ++
        } else {
            If ($Exits.keys -contains "(U)") {$global:ActionMessage = "De deur zit op slot, je kunt er nu niet door."}
                Else {$global:ActionMessage = "Die kant kan je nu niet op."}
        }
        Break
        }
        'D'{
        If ($Exits.D){
            $state.location = $Exits.D
            $global:ActionMessage = $ActionMessageDown
            $state.Counter.roomvisits ++
        } else {
            If ($Exits.keys -contains "(D)") {$global:ActionMessage = "De deur zit op slot, je kunt er nu niet door."}
                Else {$global:ActionMessage = "Die kant kan je nu niet op."}
        }
        Break
        }
        {1..10 -contains $_}{
            If($_ -le $($Global:MenuOptions.length)){
                $MenuOptionString = $_ #Catch the input to a string variable
                [int]$MenuOptionInteger = [convert]::ToInt32($MenuOptionString, 10) #Convert the string variable to an int32 (base 10) variable
#                $global:ActionMessage = "Je koos 1: $MenuOptionInteger : $($Global:MenuOptions[([int32]$MenuOptionInteger-1)])"
                
                if ([string]$($Global:MenuOptions[([int32]$MenuOptionInteger-1)]) -like "Pak het toegangspasje op") { #Check if the specified array item contains the named string
                    $Global:MenuOptions = $Global:MenuOptions | Where-Object { $_ -ne "Pak het toegangspasje op" } # Remove the specified string from the array
                    $global:ActionMessage = "Je pakt het toegangspasje op." #Write ActionMessage
                    $state.self.inventory += 'een toegangspasje' #Add the specified string to the inventory
                    $state.room.$Global:RoomNumber."een toegangspasje" = $false #Remove the specified string from the room
                 Break
                }
                if ([string]$($Global:MenuOptions[([int32]$MenuOptionInteger-1)]) -like "Pak het bierflesje op") { #Check if the specified array item contains the named string
                    $Global:MenuOptions = $Global:MenuOptions | Where-Object { $_ -ne "Pak het bierflesje op" } # Remove the specified string from the array
                    $global:ActionMessage = "Je pakt het bierflesje op." #Write ActionMessage
                    $state.self.inventory += 'een bierflesje' #Add the specified string to the inventory
                    $state.room.$Global:RoomNumber."een bierflesje" = $false #Remove the specified string from the room
                 Break
                } else {
                $global:ActionMessage = "UNHIT! ArryItem gehit: $($Global:MenuOptions[([int32]$MenuOptionInteger-1)])"
                Break
                }

            } Else{
            $global:ActionMessage = "Ongeldig getal"
            }
        break
        }
        default{
        $global:ActionMessage = "Ongeldig commando, probeer het nog eens."
        }
    }

    $state | set-state
}