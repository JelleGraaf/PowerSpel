function Invoke-Room040600 {
    $state = get-state
    $global:RoomCounter ++

    Write-Host $ActionMessage -ForegroundColor Green
    Write-Host ""
    Write-Host '[Loods]' -ForegroundColor DarkBlue -BackgroundColor White
    Write-Host "De loods van OGD wordt gebruikt voor opslag van van alles: draadkarren vol met fris en bier, marketingmateriaal, stellingkasten vol gereedschap en oude CRT-TV's. Een groot rolluik in de zuidelijke muur leidt naar buiten en het lijkt erop dat deze met een druk op de knop open kan. In de noordelijke muur zit ook een deur, met een paslezer ernaast." -foregroundcolor White
    if ($state.self.inventory -contains 'Toegangspasje') {
        if ($state.self.states -contains 'LoodsdeurOpen'){
            Write-Exits "(N)" E S #Exit directions with Toegangspasje and LoodsdeurOpen
        }else{
            Write-Exits "(N)" E "(S)" #Exit directions with Toegangspasje but without LoodsdeurOpen
        }
    }Else{
        if ($state.self.states -contains 'LoodsdeurOpen'){
            Write-Exits "(N)" "(E)" S #Exit directions without Toegangspasje but with LoodsdeurOpen
        }else{
            Write-Exits "(N)" "(E)" "(S)" #Exit directions without Toegangspasje and without LoodsdeurOpen
        }    }
    Write-Host "`n`rOpties: `n`r 1: Druk op de knop van het rolluik."

    $Command = Read-Host "`n`rWat gaan we doen?"

    switch ($Command)
    {
        'N'{
        if ($state.self.inventory -contains 'ToegangspasjeAdmin') {
            $state.location =@(04,06,00) # Room is locked, returning to original room
            $global:ActionMessage = "Je stapt de serverruimte binnen. Dit is erg waardevol voor je opdracht!"
        }else{
            $state.location =@(04,06,00) # Room is locked, returning to original room
            $global:ActionMessage = "Je toegangspasje werkt niet op deze deur! Er zit vast iets belangrijks achter."
            $global:RoomCounter --
        }
        break
        }
        'E'{
        if ($state.self.inventory -contains 'Toegangspasje') {
            $state.location =@(05,06,00) #What room (coordinates) is located to the East from here, if you have Toegangspasje
            $global:ActionMessage = "Je ontgrendelt de deur met je toegangspas en loopt de deur door richting het oosten."
        }else{
        $global:ActionMessage = "De deur zit op slot, je hebt een toegangspasje nodig om hem te openen."
        $global:RoomCounter --
        }
        Break
        }
        'S'{
        if ($state.self.states -contains 'LoodsdeurOpen') {
            $state.location =@(04,05,00) #What room (coordinates) is located to the South from here, if you have LoodsdeurOpen
            $global:ActionMessage = "Je loopt door het open rolluik naar buiten, richting het zuiden."
        }else{
            $global:ActionMessage = "Het rolluik zit dicht. Probeer anders eens de rode knop, die ernaast aan de muur zit."
            $global:RoomCounter --
        }
        Break
        }
        '1'{
        If (($State.self.states) -contains "Loodsdeuropen") {
            ($State.self.states) = ($State.self.states) | Where-Object {$_ -ne "Loodsdeuropen"} # Remove LoodsdeurOpen, if present
            $global:ActionMessage = "Je drukt op de rode knop naast het rolluim en het rolluik gaat dicht."
            $global:RoomCounter --
        }else{
            $state.self.states += 'LoodsdeurOpen' # Add LoodsdeurOpen, if not present
            $global:ActionMessage = "Je drukt op de rode knop naast het rolluim en het rolluik gaat open."
            $global:RoomCounter --
        }
        break
        }
        default{
        $global:ActionMessage = "Ongeldig commando, probeer het nog eens."
        $global:RoomCounter --
        }
    }
  $state | set-state
}