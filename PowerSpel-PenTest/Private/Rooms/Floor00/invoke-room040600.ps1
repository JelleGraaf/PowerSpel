function Invoke-Room040600 {
    $state = get-state

    Write-Host '[Loods]' -ForegroundColor DarkBlue -BackgroundColor White
    Write-Host "De loods van OGD wordt gebruikt voor opslag van van alles: draadkarren vol met fris en bier, marketingmateriaal, stellingkasten vol gereedschap en oude CRT-TV's. Een groot rolluik in de zuidelijke muur leidt naar buiten en het lijkt erop dat deze met een druk op de knop open kan. In de noordelijke muur zit ook een deur, met een paslezer ernaast." -foregroundcolor White
    if ($state.self.inventory -contains 'Toegangspasje') {
        if ($state.self.states -contains 'LoodsdeurOpen'){
            Write-Exits "(N)" E S #Exit directions with Toegangspasje and LoodsdeurOpen
        }else{
            Write-Exits "(N)" E "(S)" #Exit directions with Toegangspasje but without LoodsdeurOpen
        }
    }Else{
        if ($state.self.states -contains 'LoodsdeurOpen'){
            Write-Exits "(N)" "(E)" S #Exit directions without Toegangspasje but with LoodsdeurOpen
        }else{
            Write-Exits "(N)" "(E)" "(S)" #Exit directions without Toegangspasje and without LoodsdeurOpen
        }    }
    Write-Host "`n`rOpties: `n`r 1: Druk op de knop van het rolluik."

    $Command = Read-Host "`n`rWat gaan we doen?"

    switch ($Command)
    {
        'N'{
        $state.location =@(04,06,00) #Door is locked, returning to same room
        break
        }
        'E'{
        if ($state.self.inventory -contains 'Toegangspasje') {
            $state.location =@(05,06,00) #What room (coordinates) is located to the East from here, if you have Toegangspasje
        }
        break
        }
        'S'{
        if ($state.self.states -contains 'LoodsdeurOpen') {
            $state.location =@(04,05,00) #What room (coordinates) is located to the South from here, if you have LoodsdeurOpen
        }
        break
        }
        '1'{
        $state.self.states += 'LoodsdeurOpen'
        }
        default{ write-host "Ongeldige input"}
    }
  $state | set-state
}