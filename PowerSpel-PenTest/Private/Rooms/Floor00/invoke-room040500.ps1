function Invoke-Room040500 {
    $state = get-state
    Write-Host $ActionMessage -ForegroundColor Green
    Write-Host ""
    Write-Host '[Achterkant van het gebouw]' -ForegroundColor DarkBlue -BackgroundColor White
    Write-Host "Je loopt langs de achterkant van het gebouw. In de gevel is een groot rolluik van een loods geplaatst. Je ziet geen paslezer of andere mogelijkheid om dit luik te openen. Door de ramen zie je mensen met headsets die aan het praten zijn." -foregroundcolor White
    if ($state.self.states -contains 'LoodsdeurOpen'){
       Write-Exits N S W #Exit directions with LoodsdeurOpen
    }else{
       Write-Exits "(N)" S W #Exit directions without LoodsdeurOpen
    }
 
     $Command = Read-Host "`n`rWat gaan we doen?"

    switch ($Command)
    {
        'N'{
        if ($state.self.states -contains 'LoodsdeurOpen') {
            $state.location =@(04,06,00) #What room (coordinates) is located to the North from here, if you have LoodsdeurOpen
        }Else{
            $state.location =@(04,05,00) #Door is locked, returning to same room
        }
        $global:ActionMessage = "Je loopt richting het noorden"
        break
        }
        'S'{
        $state.location =@(04,04,00) #What room (coordinates) is located to the South from here
        $global:ActionMessage = "Je loopt richting het zuiden."
        break
        }
        'W'{
        $state.location =@(03,05,00) #What room (coordinates) is located to the West from here
        $global:ActionMessage = "Je loopt richting het westen."
        break
        }
        default{ $global:ActionMessage = "Ongeldig commando, probeer het nog eens."}
    }
  $state | set-state
}