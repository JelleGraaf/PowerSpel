function Invoke-Room070702 {
    $state = get-state
    $global:RoomCounter ++

    Write-Host $ActionMessage -ForegroundColor Green
    Write-Host ""
    Write-Host '[Trappenhuis tweede verdieping]' -ForegroundColor DarkBlue -BackgroundColor White
    Write-Host 'Je staat in het trappenhuis. Vanaf hier kan je richting het westen langs de toiletten, omlaag naar de eerste verdieping, of omhoog naar de derde verdieping. In de noordelijke en zuidelijke muren zitten deuren met paslezers. Er staat een tafeltennistafel en er liggen wat ballen en batjes.' -foregroundcolor White
    if ($state.self.inventory -contains 'Toegangspasje') {
        Write-Exits N S W U D #Exit directions with Toegangspasje
    }Else{
        Write-Exits "(N)" "(S)" W U D #Exit directions without Toegangspasje
    }

    $Command = Read-Host "`n`rWat gaan we doen?"

    switch ($Command)
    {
        'N'{
        if ($state.self.inventory -contains 'Toegangspasje') {
            $state.location =@(07,08,02) #What room (coordinates) is located to the North from here, if you have Toegangspasje
            $global:ActionMessage = "Je ontgrendelt de deur met je toegangspas en loopt de deur door richting het noorden."
        }else{
        $global:ActionMessage = "De deur zit op slot, je hebt een toegangspasje nodig om hem te openen."
        $global:RoomCounter --
        }
        Break
        }
        'S'{
        if ($state.self.inventory -contains 'Toegangspasje') {
            $state.location =@(07,06,02) #What room (coordinates) is located to the South from here, if you have Toegangspasje
            $global:ActionMessage = "Je ontgrendelt de deur met je toegangspas en loopt de deur door richting het zuiden."
        }else{
        $global:ActionMessage = "De deur zit op slot, je hebt een toegangspasje nodig om hem te openen."
        $global:RoomCounter --
        }
        Break
        }
        'W'{
        $state.location =@(06,07,02) #What room (coordinates) is located to the West from here
        $global:ActionMessage = "Je loopt richting het westen."
        break
        }
        'U'{
        $state.location =@(07,07,03) #What room (coordinates) is located Up from here
        $global:ActionMessage = "Je loopt de trap op naar boven."
        break
        }
        'D'{
        $state.location =@(07,07,01) #What room (coordinates) is located Down from here
        $global:ActionMessage = "Je loopt de trap af naar beneden."
        break
        }
        default{
        $global:ActionMessage = "Ongeldig commando, probeer het nog eens."
        $global:RoomCounter --
        }
    }
  $state | set-state
}