###AANROEPEN MOET NOG MET EEN KOELKASTOPTIESSPLAT, NET ALS DE KAMERS
Function Invoke-OGDDialog-Frisdrankkoelkast{
    Clear-Host
    Show-header

    Write-Host $ActionMessage -ForegroundColor Green #Write the latest action to screen
    Write-Host

    If (($State.self.states) -contains "Drankje") {
        $global:ActionMessage = "Je hebt al een drankje in je hand. Er nog een nemen heeft geen toegevoegde waarde en beperkt je wel in het openen van deuren. Je bedenkt je en zet niet nog een kop."
        Break
    } 
    
    Write-OGDKoelkastOpties cola sinas

    $Koelkastkeuze = Read-Host "Wat wil je drinken?"
    switch ($Koelkastkeuze)
    {
<#Opties worden in splat aangeboden. Als dat werkt, kan dit weg
        '1'{
            $state.self.inventory += 'een blikje cola'
            $state.self.states += 'Drankje'
            $global:ActionMessage = "Je neemt een koud blikje cola uit de koelkast."
            Break
        }
        '2'{
            $state.self.inventory += 'een blikje sinas'
            $state.self.states += 'Drankje'
            $global:ActionMessage = "Je neemt een koud blikje sinas uit de koelkast."
            Break
#>
        }
### NIEUWE INPUT 14-06-2017
        {1..10 -contains $_}{ #This hits for the numbers 1 through 10
            If($_ -le $($Global:KoelkastOpties.length)){ #Do this if the number entered is less than or equal to the length of the array MenuOptios
                $KoelkastOptiesString = $_ #Catch the menu input to a string variable
                [int]$KoelkastOptiesInteger = [convert]::ToInt32($KoelkastOptiesString, 10) #Convert the string variable to an int32 (base 10) variable
                
                $selectedKoelkastOpties = $KoelkastOpties | where {$_.Argument -eq $WriteKoelkastOptiesSplat[$KoelkastOptiesInteger - 1]}
                $global:ActionMessage = $selectedKoelkastOpties.ActionMessage
                Invoke-Command -ScriptBlock $selectedKoelkastOpties.Invoke -NoNewScope

            } Else{
            $global:ActionMessage = "Ongeldig commando, probeer het nog eens." #Do this if the number entered is greater than the length of the array MenuOptions
            }
        break
        }
### EINDE NIEUWE INPUT
        Default{
            $global:ActionMessage = "Ongeldig commando, probeer het nog eens." #Do this if the number entered is greater than the length of the array MenuOptions
            Invoke-OGDDialog-Frisdrankkoelkast
        }
    }
}
