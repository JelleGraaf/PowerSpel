#This script counts the rules in all the .ps1 files in the module. Count number of .ps1 files, Sum amount of rules in all of them combined

$moduleDir = 'D:\git\powerspell-pentest\PowerSpel-PenTest'
$files = Get-ChildItem -Path $moduleDir -Recurse -File -Filter '*.ps1'

$rulecount = @()

foreach($file in $files){
    $result = [pscustomobject]@{
        name = $file.name
        length = @(get-content $file.fullname).count
    }
    $rulecount += $result
}

Write-Host "Overzicht van het aantal bestanden (Count) en regels (Sum) van dit project: " -ForegroundColor Cyan
$rulecount | measure-object -Property length -Sum
