#This script counts the rules in all the .ps1 files in the module. Count is aantal bestanden, Sum is aantal regels

$moduleDir = 'D:\git\powerspell-pentest\PowerSpel-PenTest'
$files = Get-ChildItem -Path $moduleDir -Recurse -File -Filter '*.ps1'

$rulecount = @()

foreach($file in $files){
    $result = [pscustomobject]@{
        name = $file.name
        length = @(get-content $file.fullname).count
    }
    $rulecount += $result
}

$rulecount | measure-object -Property length -Sum
